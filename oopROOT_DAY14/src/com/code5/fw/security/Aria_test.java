package com.code5.fw.security;

import com.code5.fw.util.StringUtil;

import junit.framework.TestCase;

/**
 * @author seuk
 *
 */
public class Aria_test extends TestCase {

	/**
	 * @throws Exception
	 */
	public void test_encrypt() throws Exception {

		byte[] iv = StringUtil.hexToByte("1802E0A2B90E2F9C55E00E44D05829A5");
		byte[] key = StringUtil.hexToByte("D8D91CB33B6A77B43E92AF3D509152B2");

		Aria aria = new Aria(key, iv);

		String plan = "D6042DC91F4C2C87F1EC429DE7A879FFF23AEA6E9D90254B9534D3AE680C9AB38D434114A58715FD00758B1B635126F708FB9B82E71E34F034AB72CA2986F63F057FA1BC5583FBBC7213D1E04BF62342642B3D071F2223333B2C32C19A2F05F4479E96E8B7A8A56C4FB05E1427FE36890EB41624CE03BBBBB19E5DBB436F8E775A8A66C0545FDDB6A03378DD80D128740C7C6F027B29C4319EEB39DFADAF5B73";
		String encR = StringUtil.byteToHex(aria.encrypt_CBC_PKCS7(StringUtil.hexToByte(plan)));
		String enc = "DD3071A9DCBBD35BB6429F1C329E453A61F50463DB35AC39037E090F768B325A6ACA5C736239A33B2D3E828AB13504E6450C80574C0BF582302062A42DBB14591401CE4A6E28FD287926307BD1493B2CE564C37EC902373348286D34034FA11D1461A737986D121D36C3C4860E4EF4C8D77A4A12ED17988D51CC6B8596331649A47FC37273E7A181384FAD599F2560C60089EE9AC98C09F24D1C0592EE3FE951";

		assertEquals(encR, enc);

		String planR = StringUtil.byteToHex(aria.decrypt_CBC_PKCS7(StringUtil.hexToByte(encR)));
		System.out.println(planR);
		assertEquals(planR, plan);

	}

	public void test_encrypt2() throws Exception {

		byte[] iv = StringUtil.hexToByte("1802E0A2B90E2F9C55E00E44D05829A5");
		byte[] key = StringUtil.hexToByte("D8D91CB33B6A77B43E92AF3D509152B2");

		Aria aria = new Aria(key, iv);

		String plan = "D6042DC91F4C2C87F1EC429DE7A879FFF23AEA6E9D90254B9534D3AE680C9AB38D434114A58715FD00758B1B635126F708FB9B82E71E34F034AB72CA2986F63F057FA1BC5583FBBC7213D1E04BF62342642B3D071F2223333B2C32C19A2F05F4479E96E8B7A8A56C4FB05E1427FE36890EB41624CE03BBBBB19E5DBB436F8E775A8A66C0545FDDB6A03378DD80D128740C7C6F027B29C4319EEB39DFADAF5B7300";

		String encR = StringUtil.byteToHex(aria.encrypt_CBC_PKCS7(StringUtil.hexToByte(plan)));

		String planR = StringUtil.byteToHex(aria.decrypt_CBC_PKCS7(StringUtil.hexToByte(encR)));
		assertEquals(planR, plan);

	}

}
